---
title: "API å‚è€ƒ"
description: "Claude Code API çš„å®Œæ•´å‚è€ƒæ–‡æ¡£"
---

import { Callout } from 'nextra/components'

# API å‚è€ƒ ğŸ“–

Claude Code æä¾›äº†ä¸°å¯Œçš„ API æ¥å£ï¼Œæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€å’Œä½¿ç”¨åœºæ™¯ã€‚

## è®¤è¯

### API å¯†é’¥

æ‰€æœ‰ API è°ƒç”¨éƒ½éœ€è¦æœ‰æ•ˆçš„ API å¯†é’¥ã€‚

```bash
# è®¾ç½®ç¯å¢ƒå˜é‡
export ANTHROPIC_API_KEY="your-api-key-here"

# æˆ–åœ¨ä»£ç ä¸­è®¾ç½®
```

```javascript
const claude = new ClaudeCode({
  apiKey: 'your-api-key-here'
});
```

### è®¤è¯å¤´

```http
Authorization: Bearer your-api-key-here
Content-Type: application/json
```

## æ ¸å¿ƒ API

### ä»£ç ç”Ÿæˆ

ç”Ÿæˆç¬¦åˆè¦æ±‚çš„ä»£ç ç‰‡æ®µã€‚

```http
POST /v1/code/generate
```

**è¯·æ±‚ä½“:**

```json
{
  "prompt": "åˆ›å»ºä¸€ä¸ªç”¨æˆ·ç™»å½•ç»„ä»¶",
  "language": "typescript",
  "framework": "react",
  "context": {
    "project_type": "web",
    "styling": "tailwind"
  },
  "options": {
    "include_tests": true,
    "include_docs": true
  }
}
```

**å“åº”:**

```json
{
  "code": "import React, { useState } from 'react';\n\nconst LoginForm = () => {\n  // ç»„ä»¶å®ç°\n};\n\nexport default LoginForm;",
  "explanation": "è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ React å’Œ TypeScript æ„å»ºçš„ç™»å½•è¡¨å•ç»„ä»¶...",
  "tests": "import { render, screen } from '@testing-library/react';\nimport LoginForm from './LoginForm';\n\ndescribe('LoginForm', () => {\n  // æµ‹è¯•ä»£ç \n});",
  "metadata": {
    "language": "typescript",
    "framework": "react",
    "estimated_lines": 45,
    "complexity": "medium"
  }
}
```

### ä»£ç å®¡æŸ¥

åˆ†æä»£ç è´¨é‡å¹¶æä¾›æ”¹è¿›å»ºè®®ã€‚

```http
POST /v1/code/review
```

**è¯·æ±‚ä½“:**

```json
{
  "code": "function getUserData(id) {\n  return fetch('/api/users/' + id).then(r => r.json());\n}",
  "language": "javascript",
  "check_types": ["security", "performance", "best_practices"],
  "context": {
    "project_type": "web",
    "environment": "node"
  }
}
```

**å“åº”:**

```json
{
  "score": 7.5,
  "issues": [
    {
      "type": "security",
      "severity": "medium",
      "line": 2,
      "message": "æ½œåœ¨çš„ XSS æ¼æ´ï¼šæœªéªŒè¯ç”¨æˆ·è¾“å…¥",
      "suggestion": "æ·»åŠ è¾“å…¥éªŒè¯å’Œå‚æ•°åŒ–æŸ¥è¯¢"
    },
    {
      "type": "performance",
      "severity": "low",
      "line": 2,
      "message": "å¯ä»¥ä½¿ç”¨ç°ä»£ async/await è¯­æ³•",
      "suggestion": "ä½¿ç”¨ async/await æ›¿ä»£ Promise.then"
    }
  ],
  "suggestions": [
    "æ·»åŠ é”™è¯¯å¤„ç†",
    "å®ç°ç¼“å­˜æœºåˆ¶",
    "æ·»åŠ ç±»å‹å®šä¹‰"
  ],
  "fixed_code": "async function getUserData(id: string): Promise<User> {\n  if (!id || typeof id !== 'string') {\n    throw new Error('Invalid user ID');\n  }\n  \n  try {\n    const response = await fetch(`/api/users/${encodeURIComponent(id)}`);\n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Failed to fetch user data:', error);\n    throw error;\n  }\n}"
}
```

### ä»£ç è§£é‡Š

è§£é‡Šä»£ç çš„åŠŸèƒ½å’Œå®ç°åŸç†ã€‚

```http
POST /v1/code/explain
```

**è¯·æ±‚ä½“:**

```json
{
  "code": "const memoizedFn = useMemo(() => {\n  return (data) => expensiveOperation(data);\n}, [dependency]);",
  "language": "javascript",
  "detail_level": "detailed"
}
```

**å“åº”:**

```json
{
  "explanation": {
    "summary": "è¿™æ®µä»£ç ä½¿ç”¨ React çš„ useMemo Hook æ¥ç¼“å­˜ä¸€ä¸ªæ˜‚è´µçš„å‡½æ•°æ“ä½œ...",
    "breakdown": [
      {
        "line": 1,
        "code": "const memoizedFn = useMemo(() => {",
        "explanation": "å£°æ˜ä¸€ä¸ªå¸¸é‡ memoizedFnï¼Œä½¿ç”¨ useMemo Hook æ¥åˆ›å»ºä¸€ä¸ªè®°å¿†åŒ–çš„å‡½æ•°"
      },
      {
        "line": 2,
        "code": "return (data) => expensiveOperation(data);",
        "explanation": "è¿”å›ä¸€ä¸ªç®­å¤´å‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥å— data å‚æ•°å¹¶è°ƒç”¨ expensiveOperation"
      },
      {
        "line": 3,
        "code": "}, [dependency]);",
        "explanation": "ä¾èµ–æ•°ç»„ï¼Œåªæœ‰å½“ dependency æ”¹å˜æ—¶æ‰ä¼šé‡æ–°è®¡ç®—"
      }
    ],
    "concepts": [
      "React Hooks",
      "è®°å¿†åŒ–ï¼ˆMemoizationï¼‰",
      "æ€§èƒ½ä¼˜åŒ–",
      "ä¾èµ–æ•°ç»„"
    ],
    "performance_impact": "é€šè¿‡è®°å¿†åŒ–é¿å…åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶é‡æ–°åˆ›å»ºå‡½æ•°ï¼Œæé«˜æ€§èƒ½"
  }
}
```

### ä»£ç é‡æ„

é‡æ„ä»£ç ä»¥æé«˜å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

```http
POST /v1/code/refactor
```

**è¯·æ±‚ä½“:**

```json
{
  "code": "function calc(a, b, op) {\n  if (op === '+') return a + b;\n  if (op === '-') return a - b;\n  if (op === '*') return a * b;\n  if (op === '/') return a / b;\n}",
  "language": "javascript",
  "refactor_type": "improve_structure",
  "target_patterns": ["strategy_pattern", "error_handling"]
}
```

**å“åº”:**

```json
{
  "refactored_code": "class Calculator {\n  private operations = {\n    '+': (a: number, b: number) => a + b,\n    '-': (a: number, b: number) => a - b,\n    '*': (a: number, b: number) => a * b,\n    '/': (a: number, b: number) => {\n      if (b === 0) throw new Error('Division by zero');\n      return a / b;\n    }\n  };\n\n  calculate(a: number, b: number, op: string): number {\n    const operation = this.operations[op];\n    if (!operation) {\n      throw new Error(`Unsupported operation: ${op}`);\n    }\n    return operation(a, b);\n  }\n}",
  "changes": [
    "åº”ç”¨äº†ç­–ç•¥æ¨¡å¼æ¥å¤„ç†ä¸åŒçš„è¿ç®—æ“ä½œ",
    "æ·»åŠ äº†é”™è¯¯å¤„ç†æœºåˆ¶",
    "ä½¿ç”¨ TypeScript ç±»å‹æ³¨è§£",
    "æé«˜äº†ä»£ç çš„å¯æ‰©å±•æ€§"
  ],
  "benefits": [
    "æ›´å®¹æ˜“æ·»åŠ æ–°çš„è¿ç®—æ“ä½œ",
    "æ›´å¥½çš„é”™è¯¯å¤„ç†",
    "ç±»å‹å®‰å…¨",
    "ä»£ç æ›´æ¸…æ™°æ˜“æ‡‚"
  ]
}
```

## é¡¹ç›®ç®¡ç† API

### é¡¹ç›®åˆå§‹åŒ–

```http
POST /v1/project/init
```

**è¯·æ±‚ä½“:**

```json
{
  "name": "my-awesome-project",
  "template": "react-typescript",
  "options": {
    "include_tests": true,
    "include_docs": true,
    "use_eslint": true,
    "use_prettier": true
  }
}
```

### é¡¹ç›®åˆ†æ

```http
POST /v1/project/analyze
```

**è¯·æ±‚ä½“:**

```json
{
  "project_path": "/path/to/project",
  "analysis_type": "full",
  "include_dependencies": true
}
```

**å“åº”:**

```json
{
  "project_info": {
    "name": "my-project",
    "type": "web",
    "language": "typescript",
    "framework": "react",
    "size": {
      "files": 156,
      "lines": 12450,
      "size_mb": 2.3
    }
  },
  "code_quality": {
    "score": 8.2,
    "issues": 12,
    "warnings": 5,
    "suggestions": 8
  },
  "dependencies": {
    "total": 45,
    "outdated": 3,
    "vulnerable": 1
  },
  "architecture": {
    "complexity": "medium",
    "maintainability": "high",
    "testability": "high"
  }
}
```

## æ–‡æ¡£ç”Ÿæˆ API

### è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£

```http
POST /v1/docs/generate
```

**è¯·æ±‚ä½“:**

```json
{
  "source_files": [
    "/src/components/Button.tsx",
    "/src/utils/helpers.ts"
  ],
  "doc_type": "api",
  "format": "markdown",
  "include_examples": true
}
```

**å“åº”:**

```json
{
  "documentation": "# API æ–‡æ¡£\n\n## Button ç»„ä»¶\n\nè¿™æ˜¯ä¸€ä¸ªå¯é‡ç”¨çš„æŒ‰é’®ç»„ä»¶...\n\n### å±æ€§\n\n- `onClick`: ç‚¹å‡»äº‹ä»¶å¤„ç†å‡½æ•°\n- `disabled`: æ˜¯å¦ç¦ç”¨æŒ‰é’®\n- `variant`: æŒ‰é’®æ ·å¼å˜ä½“\n\n### ç¤ºä¾‹\n\n```tsx\n<Button onClick={() => alert('Clicked!')} variant=\"primary\">\n  ç‚¹å‡»æˆ‘\n</Button>\n```",
  "files_processed": 2,
  "total_functions": 8,
  "total_components": 3
}
```

## æµ‹è¯•ç”Ÿæˆ API

### ç”Ÿæˆå•å…ƒæµ‹è¯•

```http
POST /v1/test/generate
```

**è¯·æ±‚ä½“:**

```json
{
  "source_code": "export function add(a: number, b: number): number {\n  return a + b;\n}",
  "test_framework": "jest",
  "coverage_target": 90,
  "include_edge_cases": true
}
```

**å“åº”:**

```json
{
  "test_code": "import { add } from './math';\n\ndescribe('add function', () => {\n  test('should add two positive numbers', () => {\n    expect(add(2, 3)).toBe(5);\n  });\n\n  test('should handle negative numbers', () => {\n    expect(add(-1, 1)).toBe(0);\n  });\n\n  test('should handle zero', () => {\n    expect(add(0, 5)).toBe(5);\n  });\n\n  test('should handle decimal numbers', () => {\n    expect(add(1.5, 2.5)).toBe(4);\n  });\n});",
  "coverage_info": {
    "estimated_coverage": 95,
    "test_cases": 4,
    "edge_cases": 2
  }
}
```

## é…ç½® API

### è·å–é…ç½®

```http
GET /v1/config
```

**å“åº”:**

```json
{
  "model": "claude-3-5-sonnet-20241022",
  "temperature": 0.7,
  "max_tokens": 4096,
  "tools": ["code_execution", "file_operations"],
  "project_context": {
    "language": "typescript",
    "framework": "react"
  }
}
```

### æ›´æ–°é…ç½®

```http
PUT /v1/config
```

**è¯·æ±‚ä½“:**

```json
{
  "temperature": 0.8,
  "max_tokens": 8192,
  "tools": ["code_execution", "file_operations", "web_search"]
}
```

## é”™è¯¯å¤„ç†

### é”™è¯¯å“åº”æ ¼å¼

```json
{
  "error": {
    "type": "ValidationError",
    "message": "Invalid request parameters",
    "details": {
      "field": "language",
      "issue": "Unsupported language: 'unknown'"
    },
    "code": "INVALID_LANGUAGE"
  }
}
```

### å¸¸è§é”™è¯¯ç 

| é”™è¯¯ç  | æè¿° | HTTP çŠ¶æ€ç  |
|-------|-----|-----------|
| `INVALID_API_KEY` | API å¯†é’¥æ— æ•ˆ | 401 |
| `RATE_LIMIT_EXCEEDED` | è¶…è¿‡é€Ÿç‡é™åˆ¶ | 429 |
| `INVALID_LANGUAGE` | ä¸æ”¯æŒçš„ç¼–ç¨‹è¯­è¨€ | 400 |
| `FILE_TOO_LARGE` | æ–‡ä»¶å¤ªå¤§ | 413 |
| `CONTEXT_TOO_LONG` | ä¸Šä¸‹æ–‡è¿‡é•¿ | 400 |
| `INTERNAL_ERROR` | å†…éƒ¨æœåŠ¡å™¨é”™è¯¯ | 500 |

## é€Ÿç‡é™åˆ¶

### é™åˆ¶è¯´æ˜

| è®¡åˆ’ | æ¯åˆ†é’Ÿè¯·æ±‚ | æ¯å°æ—¶è¯·æ±‚ | æ¯å¤©è¯·æ±‚ |
|-----|----------|----------|----------|
| å…è´¹ç‰ˆ | 20 | 100 | 1000 |
| ä¸“ä¸šç‰ˆ | 100 | 1000 | 10000 |
| ä¼ä¸šç‰ˆ | 500 | 5000 | 50000 |

### å“åº”å¤´

```http
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 95
X-RateLimit-Reset: 1640995200
```

## SDK å’Œå®¢æˆ·ç«¯åº“

### JavaScript/TypeScript

```bash
npm install @anthropic/claude-code
```

```javascript
import { ClaudeCode } from '@anthropic/claude-code';

const claude = new ClaudeCode({
  apiKey: process.env.ANTHROPIC_API_KEY
});

const result = await claude.generateCode({
  prompt: 'åˆ›å»ºä¸€ä¸ªè®¡ç®—å™¨ç»„ä»¶',
  language: 'typescript',
  framework: 'react'
});
```

### Python

```bash
pip install claude-code
```

```python
from claude_code import ClaudeCode

claude = ClaudeCode(api_key=os.getenv('ANTHROPIC_API_KEY'))

result = claude.generate_code(
    prompt='åˆ›å»ºä¸€ä¸ªè®¡ç®—å™¨ç»„ä»¶',
    language='python',
    framework='flask'
)
```

### Go

```bash
go get github.com/anthropics/claude-code-go
```

```go
package main

import (
    "github.com/anthropics/claude-code-go"
)

func main() {
    client := claudecode.NewClient(os.Getenv("ANTHROPIC_API_KEY"))
    
    result, err := client.GenerateCode(claudecode.GenerateCodeRequest{
        Prompt:    "åˆ›å»ºä¸€ä¸ªHTTPæœåŠ¡å™¨",
        Language:  "go",
        Framework: "gin",
    })
}
```

## Webhook é›†æˆ

### é…ç½® Webhook

```http
POST /v1/webhooks
```

**è¯·æ±‚ä½“:**

```json
{
  "url": "https://your-app.com/webhook",
  "events": ["code.generated", "review.completed"],
  "secret": "your-webhook-secret"
}
```

### Webhook äº‹ä»¶

```json
{
  "event": "code.generated",
  "timestamp": "2024-01-15T10:30:00Z",
  "data": {
    "request_id": "req_123456",
    "language": "typescript",
    "lines_generated": 45,
    "success": true
  }
}
```

## æœ€ä½³å®è·µ

### æ€§èƒ½ä¼˜åŒ–

1. **ä½¿ç”¨æµå¼å“åº”** - å¯¹äºå¤§å‹ä»£ç ç”Ÿæˆä»»åŠ¡
2. **ç¼“å­˜ç»“æœ** - ç¼“å­˜é‡å¤çš„è¯·æ±‚
3. **æ‰¹é‡å¤„ç†** - åˆå¹¶å¤šä¸ªå°è¯·æ±‚
4. **å¼‚æ­¥å¤„ç†** - ä½¿ç”¨å¼‚æ­¥è°ƒç”¨æé«˜å¹¶å‘æ€§

### å®‰å…¨å»ºè®®

1. **API å¯†é’¥ç®¡ç†** - ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨å¯†é’¥
2. **è¾“å…¥éªŒè¯** - éªŒè¯æ‰€æœ‰ç”¨æˆ·è¾“å…¥
3. **é€Ÿç‡é™åˆ¶** - å®æ–½å®¢æˆ·ç«¯é€Ÿç‡é™åˆ¶
4. **é”™è¯¯å¤„ç†** - é€‚å½“å¤„ç†å’Œè®°å½•é”™è¯¯

<Callout type="info">
  **æç¤º**: æŸ¥çœ‹ [å®Œæ•´ç¤ºä¾‹](https://github.com/anthropics/claude-code-examples) äº†è§£æ›´å¤šå®é™…åº”ç”¨åœºæ™¯ã€‚
</Callout>

---

*API æ–‡æ¡£æŒç»­æ›´æ–°ä¸­ã€‚å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è®¿é—® [GitHub Issues](https://github.com/anthropics/claude-code/issues)ã€‚*